# Agent Store 需求文档 v0.2

---

## 1. 项目概述
### 1.1 背景
随着各类 AI Agent 的快速涌现，开发者与终端用户难以快速发现、评估并使用最合适的 Agent。Agent Store 旨在提供一个集"发现 -> 评估 -> 体验"为一体的平台，并通过智能对话为用户精准匹配场景最佳 Agent。

### 1.2 目标
- 搭建一个高质量、可持续更新的 Agent 目录。
- 通过多轮对话与隐式行为数据，为用户提供个性化推荐。
- 为 Agent 开发团队提供曝光、用户反馈与运营工具。
- 构建社区与数据闭环，形成网络效应与壁垒。
- **非商业化定位**：专注产品体验，通过免费服务建立用户基础和数据壁垒。

---

## 2. 目标用户与价值
| 用户角色 | 核心痛点 | Agent Store 价值 |
| -------- | -------- | ---------------- |
| 终端使用者（个人效率党、SaaS 采购、顾问） | 难以判断 Agent 质量；场景适配度不明；学习成本高 | 目录浏览 + 智能匹配；最佳实践一键试用；媒体摘要/播客降低学习曲线 |
| Agent 开发团队 | 曝光难；口碑建立慢；缺少高质量反馈 | "被收录"即认证；流量入口；隐式质量指标与用户需求洞察 |
| 投资/咨询机构（次级） | 赛道动态分散；缺乏早期数据 | 数据 API；榜单与报告 |

---

## 3. 主要用户旅程 (Happy Path)
1. **发现**：用户访首页 → 浏览分类 / 搜索关键词 → 查看 Agent 卡片。
2. **匹配**：用户点击"智能匹配" → 自然语言描述需求 → LLM 多轮澄清 → 返回 Top N Agent 列表（含适配度理由）。
3. **评估**：进入 Agent 详情页 → 阅读基础信息 + 媒体摘要 + 最佳实践 → （可试听播客）。
4. **体验**：点击"一键试用" → 跳转官网 → 记录调用日志。
5. **留存**：收藏 / 订阅 Agent → 接收更新推送 → 再次使用。

---

## 4. 功能需求
### 4.1 目录 & 搜索
- 分类维度：应用场景、行业、技术栈、热门程度、最新上线。
- 搜索：关键词 + Filter（免费 / 付费、开源 / 闭源…）。
- SEO：静态 SSR URL，自动生成 Open Graph 元数据。

### 4.2 智能匹配对话
- **Dialogue Intake**：LLM 引导式提问补全缺失参数（行业、目标、预算、技术限制）。
- **Ranking**：需求向量 vs Agent 向量相似度 + 显性标签 match + 业务权重。
- **输出**：Top N（≤5）结果卡片 + 匹配理由（来源字段）。

### 4.3 Agent 详情页
1. **信息卡**：功能、定价、API 链接、Demo。
2. **媒体动态**：抓取公众号/X/Twitter/YouTube/小红书 等公开内容列表。
3. **产品设计哲学/增长方法论摘要**：LLM 整理主题化摘要，附 citation，可一键播放播客 (TTS)。
4. **最佳实践 / Playbooks**（新增模块）
   - 文字或视频卡片；含标题、标签、步骤概要、一次点击"试用"。
   - 轻量"有帮助/无帮助"投票，代替星级。
5. **互动提问**：嵌入式 Agent Bot（RAG：知识库 + Playbook）。

### 4.4 Playbook 管理
- **MVP阶段**：仅开放官方投稿通道，建立Markdown模板规范，自动Smoke Test验证基础格式。
- **后续迭代**：引入人工审核机制，分级审核：官方 > 邀请用户 > 全社区，基于隐式质量信号进行动态排序。
- 投稿流程：Markdown 模板 / 视频上传 → 自动 Smoke Test → 人工审核 → 上线。
- 数据字段：见 §5 数据模型。
- 权限：官方 / 邀请用户 / 全社区（阶段性开放）。

### 4.5 媒体内容管理
- **双重抓取策略**：
  - 自动抓取：定时任务抓取已知媒体源
  - 用户提交：允许用户主动提交相关链接，提交后进入审核队列，通过后加入自动抓取白名单
- **内容质量控制**：管理员后台统一审核，避免重复内容，确保内容质量。

### 4.6 用户账户
- 登录：邮箱 + OAuth。
- 个人中心：收藏、历史调用日志、贡献徽章。

### 4.7 隐式质量信号
- 指标：调用成功率、平均会话时长、复访率、Playbook 使用转化率。
- 用途：生成场景标签热度、榜单、搜索排序因子。

### 4.8 管理后台
- Agent 审核 / 上架下架。
- 媒体源配置与抓取状态。
- Playbook 审核、Smoke Test 结果。
- 用户提交链接审核。
- 指标仪表盘：DAU、转化、内容更新频率。

---

## 5. 核心数据模型（简化示例）
### 5.1 Agent
| 字段 | 类型 | 描述 |
| ---- | ---- | ---- |
| agent_id | UUID | 主键 |
| name | text |
| description | text |
| tags | string[] |
| price_tier | enum(free, freemium, paid) |
| api_endpoint | text |
| media_sources | jsonb | 微信号 / RSS / YouTube 等 |
| embed_vector | vector(1536) |
| health_score | float | 计算得分 |

### 5.2 Playbook
| 字段 | 类型 | 描述 |
| ---- | ---- | ---- |
| playbook_id | UUID | 主键 |
| agent_id | FK | 关联的 Agent ID |
| title | text | Playbook 标题 |
| media_type | enum(text, video) | 内容类型 |
| tags | string[] | 标签数组 |
| steps_markdown | text | 步骤说明（Markdown 格式） |
| video_url | text | 视频链接（可选） |
| embed_vector | vector | 向量嵌入 |
| author_type | enum(official, user) | 作者类型 |
| verified | bool | 是否已验证 |
| clicks | int | 点击次数 |
| success_runs | int | 成功运行次数 |

### 5.3 用户提交链接
| 字段 | 类型 | 描述 |
| ---- | ---- | ---- |
| submission_id | UUID | 主键 |
| user_id | FK | 提交用户ID |
| agent_id | FK | 关联的Agent ID |
| url | text | 提交的链接 |
| title | text | 链接标题 |
| description | text | 用户描述 |
| status | enum(pending, approved, rejected) | 审核状态 |
| submitted_at | timestamp | 提交时间 |
| reviewed_at | timestamp | 审核时间 |

---

## 6. 技术架构概览
- **前端**：Next.js + RSC；Tailwind + shadcn/ui；Framer Motion 动效。
- **API 网关**：FastAPI + 中间件（Auth、Rate-limit、缓存、CORS）。
- **LLM 应用层**：Haystack 2.x + 自定义 Pipeline
  - 智能匹配 Pipeline：需求理解 → 向量检索 → 重排序 → 推荐生成
  - RAG Pipeline：知识库检索 → 上下文增强 → 回答生成
  - 内容摘要 Pipeline：媒体内容 → 清洗 → 摘要生成
- **向量存储**：pgvector（PostgreSQL 扩展）+ Haystack DocumentStore
- **LLM 服务**：Deepseek
- **内容管线**：无头浏览器抓取 → 清洗 → Haystack 摘要 Pipeline → S3 存储
- **TTS**：OpenAI Audio API；转码 HLS
- **监控**：Prometheus + Grafana；Error Tracking Sentry。

---

## 7. 非功能需求
| 类别 | 需求 |
| ---- | ---- |
| 性能 | 首页加载 < 2 s；匹配结果 < 3 s 返回 |
| 可用性 | 99.5% Uptime；支持灰度发布 |
| SEO | SSR + Sitemap + JSON-LD；CLS < 0.1 |
| 安全 | OAuth2、HTTPS、WAF、防爬策略；GDPR 合规 |
| 隐私 | 对话数据脱敏存储；用户可导出/删除数据 |

---

## 8. 指标与分析
- **North Star**：由匹配对话产生的"首日完成任务"次数 / DAU。
- 关键指标
  - 浏览层：搜索点击率、详情页停留时长
  - 匹配层：澄清完成率、推荐点击率
  - 体验层：调用成功率、Playbook 复制率
  - 留存层：次周回访率

---

## 9. MVP 范围与迭代计划
### 9.1 第一阶段（MVP）
| 模块 | MVP Must-have |
| ---- | ------------- |
| 目录 & 搜索 | ✔ 分类 / 搜索 / Agent 卡片 |
| 智能匹配 | ✔ 单轮 Intake + Top 3 推荐 |
| 详情页 | ✔ 基本信息卡 + 媒体动态 + 1 条官方 Playbook |
| Playbook 投稿 | ✔ 仅官方投稿通道 |
| 用户账户 | ✔ 登录 + 收藏 |
| 管理后台 | ✔ Agent & Playbook 审核 |

### 9.2 第二阶段
- 媒体内容抓取（自动 + 用户提交）
- 多轮智能匹配对话
- 用户Playbook投稿（人工审核）

### 9.3 第三阶段
- 社区功能（评价、讨论）
- 高级推荐算法
- 数据API开放

---

## 10. 里程碑计划 (建议)
| 阶段 | 时间 | 交付 |
| ---- | ---- | ---- |
| M0 | T+2 周 | 低保真线框 & 技术 Spike |
| M1 | T+6 周 | MVP 上线（目录+简易匹配） |
| M2 | T+12 周 | Playbook 区块 + 隐式信号榜单 |
| M3 | T+20 周 | 开放用户投稿 + 迭代推荐算法 |

---

## 11. 风险与对策
| 风险 | 对策 |
| ---- | ---- |
| 抓取源变动 / 反爬 | 第三方抓取服务；缓存；用户提交链接兜底 |
| 内容质量参差 | 分级审核；隐式指标过滤；人工编辑精选 |
| 刷量作弊 | 调用日志校验；异常检测；人工复核 |
| 非商业化可持续性 | 专注产品体验；建立数据壁垒；探索开源社区模式 |

---

## 12. 验收标准
1. 通过 E2E 测试：目录浏览、匹配推荐、Playbook 复制全链路。
2. 95% Agent 详情页在 < 1 s 内渲染。
3. 体验转化率 ≥ 10%（匹配→试用）。
4. 抓取管线 24h 内完成媒体更新，全链路成功率 ≥ 98%。
5. 用户提交链接审核周期 ≤ 48小时。

---

> **版本记录**
> - v0.1 (2025-07-02) 首版草案
> - v0.2 (2025-01-XX) 更新内容质量控制策略、非商业化定位、用户提交链接功能

